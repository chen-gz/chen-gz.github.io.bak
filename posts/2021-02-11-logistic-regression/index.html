<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        class="dark-mode-native-dark-original" />
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
     
    <link rel="stylesheet" href="https://zongpitt.com/sass/main.c39648138d682d57646995e2f7b6d07135e26e85a51c5f54e30a1a26602d30d5.css" />
    <title>
          Guangzong Blog | Logistic Regression
    </title>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>
    <script src=" https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

    <script
        src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>
    <script type="text/javascript" src="/js/commons/back-to-top.js"></script>
    
    
    
    <script type="text/javascript" src="/js/commons/topbar-switch.js"></script>
    <script type="text/javascript" src="/js/commons/sidebar.js"></script>
    <script type="text/javascript" src="/js/utils/category-collapse.js"></script>
    <script type="text/javascript" src="/js/utils/checkbox.js"></script>
    <script type="text/javascript" src="/js/utils/clipboard.js"></script>
    <script type="text/javascript" src="/js/utils/img-extra.js"></script>
    <script type="text/javascript" src="/js/utils/pageviews.js"></script>
    
    <script type="text/javascript" src="/js/utils/timeago.js"></script>
    
    
</head>
<body data-spy="scroll" data-target="#toc" data-topbar-visible="true" class="d-flex"><div id="sidebar" class="d-flex flex-column align-items-end">
    <div class="profile-wrapper text-center">

        <div id="avatar">
            <a href="/" alt="avatar" class="mx-auto"> <img src=https://github.com/chen-gz/chen-gz/blob/main/mine_square.jpg?raw&#61;truehttps://raw.githubusercontent.com/chen-gz/chen-gz/blob/main/mine_square.jpg alt="avatar"
                    onerror="this.style.display='none'"> </a>
        </div>

        <div class="site-title mt-3"> <a href="/">Guangzong</a> </div>
        <div class="site-subtitle font-italic">Welcome to my blog</div>
    </div>

    <ul>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/">
                <span>
                    Home
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/archive/">
                <span>
                    Archive
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/tags/">
                <span>
                    Tags
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/about/">
                <span>
                    About
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/categories/">
                <span>
                    Categories
                </span>
            </a>
        </li>
        
    </ul>

    <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">
        <button class="mode-toggle btn" aria-label="Switch Mode"> 
            <i class="fas fa-adjust"></i> 
        </button>

        <span class="icon-border"></span>
        <a href="https://github.com/chen-gz" aria-label="github" target="_blank" rel="noopener">
            <i class="fab fa-github"></i>
        </a>

        <a href=" javascript:location.href = 'mailto:' + ['chen-gz','outlook.com'].join('@')" aria-label="email">
            <i class="fas fa-envelope"></i>
        </a>

        <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a>
    </div>

    
    
</div>
<div id="all-wrapper" class="d-flex flex-column"><div id="topbar-wrapper">
    <div id="topbar" class="d-flex">
        
        <span id="breadcrumb" class="d-flex">
              
               
            
            
            <div><a href='https://zongpitt.com/'>Home</a></div>
              
              
            
            <div><a href="https://zongpitt.com/posts">posts</a></div>
               
                 
                
        </span>
        <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
        <div id="topbar-title">Guangzong</div>
        <i id="search-trigger" class="fas fa-search fa-fw"></i>
        <span id="search-wrapper" class="align-items-center">
            <i class="fas fa-search fa-fw"></i>
            <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off"
                placeholder="Search..." />
            <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
        </span>
    </div>
</div>
<div id="main-wrapper" class="d-flex mt-3">
            <div id="core-wrapper" class="d-flex flex-column">
                <div id="main" class="d-flex flex-column">
                    
<div class="post pl-1 pr-1 pl-md-2 pr-md-2">
    
    <div id="post-content">
        <h1 style="text-align: center;">Logistic Regression</h1>
        <br>
        
        <embed src="/assets/post_pdf/2020-02-11-logistic-regression.html" width="100%" height="700px"/>
<p>For many logistic regression note they will put cost function as</p>
<p><span class="math display">\[
J = - \frac{1}{N} l(\theta)
\]</span></p>
<p>I am not doing this here, basicaly we can use gradien ascent to to
maximized cost function in the notes instread of gradient decent. Ther
are almost the same. I alos want to comment \(1/m\) here, for gradient
descent algorithm, what we care about is gradient descent direction. We
will choose learning rate to change gradient descent speed. If \(1/m\)
did put in the cost function, it will as same as learn rate \(alpha/m\).
So for algorithm actually they are same.</p>
<p>If we using library to implement this algorithm, maybe we need to
read the documnt to distinguish how they implement this algorithm in
order to choose proper learning rate.</p>
<p>my Matlab implementation</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span> <span class="co">% learning rate</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">feature_size</span> <span class="op">=</span> <span class="fl">2</span><span class="op">;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">iter</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">theta</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="va">feature_size</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">theta</span> <span class="op">=</span> [<span class="fl">1</span> <span class="fl">1</span>]<span class="op">&#39;;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span> <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">0</span> <span class="fl">1</span>]<span class="op">&#39;;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="va">costs</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="fl">1</span><span class="op">,</span> <span class="va">iter</span>)<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">iter</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">costs</span>(<span class="va">i</span>) <span class="op">=</span> <span class="va">my_cost</span>( <span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">theta</span>)<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">partical_cost</span> <span class="op">=</span> <span class="va">my_part_cost</span>(<span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">theta</span>)<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">theta</span> <span class="op">=</span> <span class="va">theta</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">.*</span> <span class="va">partical_cost</span><span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">costs</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span>  <span class="va">y</span> <span class="op">=</span> <span class="va">my_sigmoid</span>(<span class="va">x</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="va">y</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">./</span>(<span class="fl">1</span> <span class="op">+</span> <span class="va">exp</span>(<span class="op">-</span><span class="va">x</span>))<span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">cost</span> <span class="op">=</span> <span class="va">my_cost</span>( <span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">theta</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="va">cost</span> <span class="op">=</span> <span class="va">y</span><span class="op">&#39;</span> <span class="op">.*</span> (<span class="va">theta</span><span class="op">&#39;</span> <span class="op">*</span> <span class="va">x</span>) <span class="op">-</span> <span class="va">log</span>(<span class="fl">1</span> <span class="op">+</span> <span class="va">exp</span>(<span class="va">theta</span><span class="op">&#39;</span> <span class="op">*</span> <span class="va">x</span>))<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="va">cost</span> <span class="op">=</span> <span class="va">sum</span>(<span class="va">cost</span>)<span class="op">;</span> <span class="co">% this one is for maximize</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="va">cost</span> <span class="op">=</span> <span class="op">-</span><span class="va">cost</span><span class="op">;</span>     <span class="co">% for minimize</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">part_cost</span> <span class="op">=</span> <span class="va">my_part_cost</span>(<span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">theta</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="va">part_cost</span> <span class="op">=</span> <span class="va">sum</span>(<span class="va">x</span> <span class="op">.*</span> (<span class="va">y</span><span class="op">&#39;</span> <span class="op">-</span> <span class="va">my_sigmoid</span>(<span class="va">theta</span><span class="op">&#39;</span> <span class="op">*</span> <span class="va">x</span>))<span class="op">,</span><span class="fl">2</span>)<span class="op">;</span> <span class="co">% for maximize cost function</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="va">part_cost</span> <span class="op">=</span> <span class="op">-</span><span class="va">part_cost</span><span class="op">;</span>  <span class="co">% for minimize cost function</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<p>And also provide other algorithm to implement logistic regression.
Here is two mathod to implement logistic regreesion, Newton Method and
Stochastic gridient descent.</p>
<p>Newton method is based on hessian metric, Hessian method actually is
second order derivation. Newton method will converge much faster than
gradient descent. But the probelm of Newton method is it need to compute
invert of hessian matrix. So if the feature size is really large it will
require lot of computation.(computation is slow)</p>
<p>Hessian max is how as bellow</p>
<p><span class="math display">\[
hessian = \frac{\nabla^{2} !(\theta)}{\partial \theta}=-\sum_{i=1}^{n}
\tilde{x}_{i} \tilde{x}_{i}^{T} g\left(\theta^{T}
\tilde{x}_{i}\right)\left(1-g\left(\theta^{T}
\tilde{x}_{i}\right)\right)
\]</span></p>
<p>update rule <span class="math display">\[
x^{j+1}=x^{j}-\left.\left(\nabla^{2} f(x)\right)^{-1} \nabla
f(x)\right|_{x=x^{j}}
\]</span> Code for Newton method. Just replace line 19-24 by following
code section.</p>
<pre><code>for i = 1:iter
    costs(i) = my_cost( x, y, theta);
    hessian = x .* my_sigmoid((theta&#39; * x)) * x&#39;;
    partical_cost = my_part_cost(x, y, theta); 
    theta = theta - inv(hessian) * partical_cost;
end</code></pre>
<p>Stochastic gradient is useful when batch is too large. But Stochastic
will take much more iteration to converge. I would not privide
stochastic gradient decent code here. It is easy. Just randomly pick an
sample and do gradient decent base on this sample.</p>
<blockquote>
<p>Materials from Dr. Can</p>
</blockquote>

    </div>
    
</div>
</div>

                <div id="footer-wrapper">
                    <footer class="footer"><footer class="row pl-3 pr-3">
    <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
        <div class="footer-left">
            <p class="mb-0"> © 2022 <a href="https://github.com/chen-gz">guangzong</a>. <span data-toggle="tooltip"
                    data-placement="top"
                    title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All
                    rights reserved.</span></p>
        </div>
        <div class="footer-right">
            <p class="mb-0"> Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">hugo</a>
                with <a href="https://github.com/chen-gz/hugo_zong" target="_blank" rel="noopener">zong</a>
                theme.</p>
        </div>
    </div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script> MathJax = {
            tex: {
                tags: 'ams',
            }
        };</script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</footer>
</footer>
                </div>
            </div>
            <div id="panel-wrapper" class="d-flex flex-column"><div id="toc-wrapper" class="mb-5 pl-2">
    <span>Contents</span>
    <nav id="toc" data-toggle="toc">
        
        
        
    </nav>
</div>

<div id="access-lastmod" class="pb-4 pl-2">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-3 pb-1 ml-1 mt-2">
          
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/4-completion-of-product-measures/">4 Completion of Product Measures</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/2-product-measures/">2 Product Measures</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/3-the-fubini-theorem/">3 The Fubini Theorem</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/1-measurability-on-cartesian-products/">1 Measurability on Cartesian Products</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-7/3-differentiable-transformations/">Differentiable Transformations</a></li>
        
    </ul>
</div>









































































































































































































































































































</div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
    <div class="col-12 col-sm-11 post-content">
        <div id="search-hints"></div>
        <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3 col-12"></div>
    </div>
</div>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script>


</div>
        <div id="mask"></div>
        <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"
            style="display: none">
            <i class="fas fa-angle-up"></i>
        </a>
    </div>
    
</body>

</html>
