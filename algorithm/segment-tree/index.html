<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        class="dark-mode-native-dark-original" />
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
     
    <link rel="stylesheet" href="https://zongpitt.com/sass/main.c39648138d682d57646995e2f7b6d07135e26e85a51c5f54e30a1a26602d30d5.css" />
    <title>
          Guangzong Blog | Segment Tree
    </title>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>
    <script src=" https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

    <script
        src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>
    <script type="text/javascript" src="/js/commons/back-to-top.js"></script>
    
    
    
    <script type="text/javascript" src="/js/commons/topbar-switch.js"></script>
    <script type="text/javascript" src="/js/commons/sidebar.js"></script>
    <script type="text/javascript" src="/js/utils/category-collapse.js"></script>
    <script type="text/javascript" src="/js/utils/checkbox.js"></script>
    <script type="text/javascript" src="/js/utils/clipboard.js"></script>
    <script type="text/javascript" src="/js/utils/img-extra.js"></script>
    <script type="text/javascript" src="/js/utils/pageviews.js"></script>
    
    <script type="text/javascript" src="/js/utils/timeago.js"></script>
    
    
</head>
<body data-spy="scroll" data-target="#toc" data-topbar-visible="true" class="d-flex"><div id="sidebar" class="d-flex flex-column align-items-end">
    <div class="profile-wrapper text-center">

        <div id="avatar">
            <a href="/" alt="avatar" class="mx-auto"> <img src=https://github.com/chen-gz/chen-gz/blob/main/mine_square.jpg?raw&#61;truehttps://raw.githubusercontent.com/chen-gz/chen-gz/blob/main/mine_square.jpg alt="avatar"
                    onerror="this.style.display='none'"> </a>
        </div>

        <div class="site-title mt-3"> <a href="/">Guangzong</a> </div>
        <div class="site-subtitle font-italic">Welcome to my blog</div>
    </div>

    <ul>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/">
                <span>
                    Home
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/archive/">
                <span>
                    Archive
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/tags/">
                <span>
                    Tags
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/about/">
                <span>
                    About
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/categories/">
                <span>
                    Categories
                </span>
            </a>
        </li>
        
    </ul>

    <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">
        <button class="mode-toggle btn" aria-label="Switch Mode"> 
            <i class="fas fa-adjust"></i> 
        </button>

        <span class="icon-border"></span>
        <a href="https://github.com/chen-gz" aria-label="github" target="_blank" rel="noopener">
            <i class="fab fa-github"></i>
        </a>

        <a href=" javascript:location.href = 'mailto:' + ['chen-gz','outlook.com'].join('@')" aria-label="email">
            <i class="fas fa-envelope"></i>
        </a>

        <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a>
    </div>

    
    
</div>
<div id="all-wrapper" class="d-flex flex-column"><div id="topbar-wrapper">
    <div id="topbar" class="d-flex">
        
        <span id="breadcrumb" class="d-flex">
              
               
            
            
            <div><a href='https://zongpitt.com/'>Home</a></div>
              
              
            
            <div><a href="https://zongpitt.com/algorithm">algorithm</a></div>
               
                 
                
        </span>
        <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
        <div id="topbar-title">Guangzong</div>
        <i id="search-trigger" class="fas fa-search fa-fw"></i>
        <span id="search-wrapper" class="align-items-center">
            <i class="fas fa-search fa-fw"></i>
            <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off"
                placeholder="Search..." />
            <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
        </span>
    </div>
</div>
<div id="main-wrapper" class="d-flex mt-3">
            <div id="core-wrapper" class="d-flex flex-column">
                <div id="main" class="d-flex flex-column">
                    
<div class="post pl-1 pr-1 pl-md-2 pr-md-2">
    
    <div id="post-content">
        <h1 style="text-align: center;">Segment Tree</h1>
        <br>
        
        <h2 id="background">Background</h2>
<p>In <a href="https://en.wikipedia.org/wiki/Computer_science">computer
science</a>, a <strong>segment tree,</strong> also known as a statistic
tree, is a <a
href="https://en.wikipedia.org/wiki/Tree_(data_structure)">tree</a> <a
href="https://en.wikipedia.org/wiki/Data_structure">data structure</a>
used for storing information about <a
href="https://en.wikipedia.org/wiki/Interval_(mathematics)">intervals</a>,
or segments. It allows querying which of the stored segments contain a
given point. It is, in principle, a static structure; that is, it’s a
structure that cannot be modified once it’s built. A similar data
structure is the <a
href="https://en.wikipedia.org/wiki/Interval_tree">interval tree</a>.<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a></p>
<p>Space Complexity: <span class="math inline">\(O(n\log n)\)</span></p>
<p>Time Complexity:</p>
<ol type="1">
<li>build the tree: <span class="math inline">\(O(n \log
n)\)</span></li>
<li>query: <span class="math inline">\(O(\log n)\)</span></li>
<li>node update: <span class="math inline">\(O(\log n)\)</span></li>
</ol>
<p>A segment tree is a binary tree, each node contains information for a
segment of the original array. The value in the node segment tree is
some attribute of the range. i.e. sum, min, max, gcd, etc.</p>
<p>An example of a segment tree. (attribute: sum)</p>
<pre class="mermaid"><code>graph TD;
    A(10, 1-4) --&gt; B(3, 1-2);
    A --&gt; C(7, 3-4);
    B --&gt; D(1, 1-1) ;
    B --&gt; E(2, 2-2);
    C --&gt; F(3, 3-3);
    C --&gt; G(4, 4-4);</code></pre>
<p>The root will contain the attribution for the whole array (range
1-4). The left and right subtrees contain the range(1-2) and range(3-4),
and so on. The leaves are the original value of the array.</p>
<h2 id="the-node-of-the-tree">The node of the tree</h2>
<p>The node of the tree contains the attribute we want to maintain and
the left bound and right bound of the node (segment).</p>
<script src="https://gist.github.com/chen-gz/3a78875ae4d41c126f8920a50983a42d.js"></script>
<h2 id="build-the-tree">Build the tree</h2>
<p>I use the recursive method to build the tree. I build a segment tree
from the root. The value in the root can get from the left subtree and
right subtree. So before setting the value for the root node, we need to
build the left and right subtree. When build left subtree and right
subtree with the same idea.</p>
<p>Following the code which builds the tree. The whole tree is stored in
an array. Suppose the root is in index 1. Because a segment tree is a
binary tree. So it has two subtrees. we can put the child of 1 in
indexes 2 and 3. Node 2 has 2 children so we need to put it in 4 and 5.
Thus the children of node 3 will be in indexes 6 and 7. We can find the
pattern, the index left tree of <code>node</code> is
<code>node * 2  = node &lt;&lt; 1</code>, the index of right tree of
<code>node</code> is <code>node * 2 + 1 = node &lt;&lt; 1 | 1</code>.
When we build the tree, we also need the assign left bound and right
bound to the node. The left bound and right bound can get from the
parent segment. Because we are dividing the parent segment into
two-part. So the bound of the left subtree is <code>l, mid</code>, the
bound of the right subtree is <code>mid + 1, r</code> where the
<code>l</code> and <code>r</code> are the bound of the current node and
<code>mid = (l + r ) / 2</code>.</p>
<p>Because we are using the recursive method to build the tree, there is
a terminal condition. The terminal condition is we arrive at the leaves.
The condition to judgment a leaf is the right boundary equals the left
boundary ( <code>l == r</code> in the code).</p>
<script src="https://gist.github.com/chen-gz/652ec9049188a0b0eedc83f6168bc5fa.js"></script>
<h2 id="update-node">Update (node)</h2>
<p>Update a node in the segment tree. We are using the recursive method
to update the value. The root node definitely will affect the new node,
because it needs information from the whole array. Since two subtree
does not have an intersection, so only one subtree will affect by the
new node. Thus we only update one of the subtree.</p>
<script src="https://gist.github.com/chen-gz/d01572339af98015dc7e7b4c6fc9bf46.js"></script>
<h2 id="update-segment-with-lazy">Update (segment with lazy)</h2>
<blockquote>
<p>Pending</p>
</blockquote>
<h2 id="query">Query</h2>
<p>The query aims to get information from the segment tree. A query
segment can be composed of many segments in the segment tree. Still
using the recursive method, when the inquiry range is larger than the
tree node range we directly return the value, otherwise, we go to the
subtree to find the value.</p>
<script src="https://gist.github.com/chen-gz/31c689828fed95f7c50a5294a2a73ba8.js"></script>
<h2 id="problem-set">Problem Set</h2>
<ol type="1">
<li><a href="https://codeforces.com/contest/1632/problem/D">Codeforces
Round #769 Problem - D - Codeforces</a></li>
<li><a href="https://codeforces.com/contest/1638/problem/E">Codeforces
Round #771 Problem - E - Codeforces</a></li>
</ol>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a
href="https://en.wikipedia.org/wiki/Segment_tree">Segment tree -
Wikipedia</a><a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

    </div>
    
</div>
</div>

                <div id="footer-wrapper">
                    <footer class="footer"><footer class="row pl-3 pr-3">
    <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
        <div class="footer-left">
            <p class="mb-0"> © 2022 <a href="https://github.com/chen-gz">guangzong</a>. <span data-toggle="tooltip"
                    data-placement="top"
                    title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All
                    rights reserved.</span></p>
        </div>
        <div class="footer-right">
            <p class="mb-0"> Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">hugo</a>
                with <a href="https://github.com/chen-gz/hugo_zong" target="_blank" rel="noopener">zong</a>
                theme.</p>
        </div>
    </div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script> MathJax = {
            tex: {
                tags: 'ams',
            }
        };</script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</footer>
</footer>
                </div>
            </div>
            <div id="panel-wrapper" class="d-flex flex-column"><div id="toc-wrapper" class="mb-5 pl-2">
    <span>Contents</span>
    <nav id="toc" data-toggle="toc">
        
        
        
    </nav>
</div>

<div id="access-lastmod" class="pb-4 pl-2">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-3 pb-1 ml-1 mt-2">
          
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/4-completion-of-product-measures/">4 Completion of Product Measures</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/2-product-measures/">2 Product Measures</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/3-the-fubini-theorem/">3 The Fubini Theorem</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-8/1-measurability-on-cartesian-products/">1 Measurability on Cartesian Products</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-7/3-differentiable-transformations/">Differentiable Transformations</a></li>
        
    </ul>
</div>









































































































































































































































































































</div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
    <div class="col-12 col-sm-11 post-content">
        <div id="search-hints"></div>
        <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3 col-12"></div>
    </div>
</div>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script>


</div>
        <div id="mask"></div>
        <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"
            style="display: none">
            <i class="fas fa-angle-up"></i>
        </a>
    </div>
    
</body>

</html>
