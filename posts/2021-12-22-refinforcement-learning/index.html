<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        class="dark-mode-native-dark-original" />
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
     
    <link rel="stylesheet" href="https://zongpitt.com/sass/main.06935202011a97ba473ebeeb0cb6788daa9fb5a9fff471a4e85850293d1c5ac4.css" />
    <title>
          Guangzong Blog | Reinforcement Learning
    </title>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>
    <script src=" https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

    <script
        src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>
    <script type="text/javascript" src="/js/commons/back-to-top.js"></script>
    
    
    
    <script type="text/javascript" src="/js/commons/topbar-switch.js"></script>
    <script type="text/javascript" src="/js/commons/sidebar.js"></script>
    <script type="text/javascript" src="/js/utils/category-collapse.js"></script>
    <script type="text/javascript" src="/js/utils/checkbox.js"></script>
    <script type="text/javascript" src="/js/utils/clipboard.js"></script>
    <script type="text/javascript" src="/js/utils/img-extra.js"></script>
    <script type="text/javascript" src="/js/utils/pageviews.js"></script>
    
    <script type="text/javascript" src="/js/utils/timeago.js"></script>
    
    
</head>
<body data-spy="scroll" data-target="#toc" data-topbar-visible="true" class="d-flex"><div id="sidebar" class="d-flex flex-column align-items-end">
    <div class="profile-wrapper text-center">

        <div id="avatar">
            <a href="/" alt="avatar" class="mx-auto"> <img src=https://github.com/chen-gz/chen-gz/blob/main/mine_square.jpg?raw&#61;truehttps://raw.githubusercontent.com/chen-gz/chen-gz/blob/main/mine_square.jpg alt="avatar"
                    onerror="this.style.display='none'"> </a>
        </div>

        <div class="site-title mt-3"> <a href="/">Guangzong</a> </div>
        <div class="site-subtitle font-italic">Welcome to my blog</div>
    </div>

    <ul>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/">
                <span>
                    Home
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/archive/">
                <span>
                    Archive
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/tags/">
                <span>
                    Tags
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/about/">
                <span>
                    About
                </span>
            </a>
        </li>
        
        
        <li class="nav-item">
            

            <a class="nav-link" href="/categories/">
                <span>
                    Categories
                </span>
            </a>
        </li>
        
    </ul>

    <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">
        <button class="mode-toggle btn" aria-label="Switch Mode"> 
            <i class="fas fa-adjust"></i> 
        </button>

        <span class="icon-border"></span>
        <a href="https://github.com/chen-gz" aria-label="github" target="_blank" rel="noopener">
            <i class="fab fa-github"></i>
        </a>

        <a href=" javascript:location.href = 'mailto:' + ['chen-gz','outlook.com'].join('@')" aria-label="email">
            <i class="fas fa-envelope"></i>
        </a>

        <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a>
    </div>

    
    
</div>
<div id="all-wrapper" class="d-flex flex-column"><div id="topbar-wrapper">
    <div id="topbar" class="d-flex">
        
        <span id="breadcrumb" class="d-flex">
              
               
            
            
            <div><a href='https://zongpitt.com/'>Home</a></div>
              
              
            
            <div><a href="https://zongpitt.com/posts">posts</a></div>
               
                 
                
        </span>
        <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
        <div id="topbar-title">Guangzong</div>
        <i id="search-trigger" class="fas fa-search fa-fw"></i>
        <span id="search-wrapper" class="align-items-center">
            <i class="fas fa-search fa-fw"></i>
            <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off"
                placeholder="Search..." />
            <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
        </span>
    </div>
</div>
<div id="main-wrapper" class="d-flex mt-3">
            <div id="core-wrapper" class="d-flex flex-column">
                <div id="main" class="d-flex flex-column">
                    
<div class="post pl-1 pr-1 pl-md-2 pr-md-2">
    
    <div id="post-content">
        <h1 style="text-align: center;">Reinforcement Learning</h1>
        <br>
        
        <p>MDPs are meant to be a straightforward framing of the problem of
learning from interaction to achieve a goal. The learner and decision
maker is called the <strong>agent</strong>. The thing it interacts with,
comprising everything outside the agent, is called the
<strong>environment</strong>. These interact continually, the agent
selecting actions and the environment responding to these actions and
presenting new situations to the agent. The environment also gives rise
to rewards, special numerical values that the agent seeks to maximize
over time through its choice of actions.</p>
<p><img
src="https://raw.githubusercontent.com/chen-gz/picBed/master/20211222134552.png" /></p>
<p>time steps, <span class="math inline">\(t=0,1,2,3, \ldots\)</span> At
each time step <span class="math inline">\(t\)</span>, the agent
receives some representation of the <strong>environment’s state, <span
class="math inline">\(S_{t} \in \mathcal{S}\)</span></strong>, and on
that basis selects an <strong>action, <span class="math inline">\(A_{t}
\in \mathcal{A}(s) .{ }\)</span></strong> One time step later, in part
as a consequence of its action, the agent receives a <strong>numerical
reward, <span class="math inline">\(R_{t+1} \in \mathcal{R} \subset
\mathbb{R}\)</span></strong>, and finds itself in a <strong>new state,
<span class="math inline">\(S_{t+1} \cdot\)</span></strong></p>
<p>That is, for particular values of these random variables, <span
class="math inline">\(s^{\prime} \in \mathcal{S}\)</span> and <span
class="math inline">\(r \in \mathcal{R}\)</span>, there is a probability
of those values occurring at time <span
class="math inline">\(t\)</span>, given particular values of the
preceding state and action:</p>
<p><span class="math display">\[
p\left(s^{\prime}, r \mid s, a\right) \doteq
\operatorname{Pr}\left\{S_{t}=s^{\prime}, R_{t}=r \mid S_{t-1}=s,
A_{t-1}=a\right\}
\]</span></p>
<p>for all <span class="math inline">\(s^{\prime}, s \in \mathcal{S}, r
\in \mathcal{R}\)</span>, and <span class="math inline">\(a \in
\mathcal{A}(s)\)</span>. The function <span
class="math inline">\(p\)</span> defines the dynamics of the MDP.</p>
<p>From the four-argument dynamics function, <span
class="math inline">\(p\)</span>, one can compute anything else one
might want to know about the environment, such as the
<strong>state-transition probabilities</strong> (which we denote, with a
slight abuse of notation, as a three-argument function <span
class="math inline">\(p: \mathcal{S} \times \mathcal{S} \times
\mathcal{A} \rightarrow[0,1]\)</span>,</p>
<p><span class="math display">\[
p\left(s^{\prime} \mid s, a\right) \doteq
\operatorname{Pr}\left\{S_{t}=s^{\prime} \mid S_{t-1}=s,
A_{t-1}=a\right\}=\sum_{r \in \mathcal{R}} p\left(s^{\prime}, r \mid s,
a\right) .
\]</span></p>
<p>We can also compute the expected rewards for state-action pairs as a
two-argument function <span class="math inline">\(r: \mathcal{S} \times
\mathcal{A} \rightarrow \mathbb{R}\)</span> :</p>
<p><span class="math display">\[
r(s, a) \doteq \mathbb{E}\left[R_{t} \mid S_{t-1}=s,
A_{t-1}=a\right]=\sum_{r \in \mathcal{R}} r \sum_{s^{\prime} \in
\mathcal{S}} p\left(s^{\prime}, r \mid s, a\right),
\]</span></p>
<p>and the expected rewards for state-action-next-state triples as a
three-argument function <span class="math inline">\(r: \mathcal{S}
\times \mathcal{A} \times \mathcal{S} \rightarrow
\mathbb{R}\)</span></p>
<p><span class="math display">\[
r\left(s, a, s^{\prime}\right) \doteq \mathbb{E}\left[R_{t} \mid
S_{t-1}=s, A_{t-1}=a, S_{t}=s^{\prime}\right]=\sum_{r \in \mathcal{R}} r
\frac{p\left(s^{\prime}, r \mid s, a\right)}{p\left(s^{\prime} \mid s,
a\right)} .
\]</span></p>
<h3 id="return-and-episodes">Return and Episodes</h3>
<p>In general, we seek to maximize the <strong>expected return</strong>,
where the return, denoted <span class="math inline">\(G_{t}\)</span>, is
defined as some specific function of the reward sequence. In the
simplest case the return is the sum of the rewards:</p>
<p><span class="math display">\[
G_{t} \doteq R_{t+1}+R_{t+2}+R_{t+3}+\cdots+R_{T},
\]</span></p>
<p>where <span class="math inline">\(T\)</span> is a final time step.
This approach makes sense in applications in which there is a natural
notion of final time step, that is, when the agent–environment
interaction breaks naturally into subsequences, which we call
<strong>episodes</strong>. Each episode ends in a special state called
the <strong>terminal state</strong>, followed by a reset to a standard
starting state or to a sample from a standard distribution of starting
states.</p>
<h3 id="policies-and-value-functions">Policies and Value Functions</h3>
<p>Almost all reinforcement learning algorithms involve estimating
<strong>value functions</strong> – functions of states (or of
state-action pairs) that estimate <em>how good</em> it is for the agent
to be in a given state (or how good it is to perform a given action in a
given state).</p>
<p>Formally, a <strong>policy</strong> is a mapping from states to
probabilities of selecting each possible action. If the agent is
following policy <span class="math inline">\(\pi\)</span> at time <span
class="math inline">\(t\)</span>, then <span class="math inline">\(\pi(a
\mid s)\)</span> is the probability that <span
class="math inline">\(A_{t}=a\)</span> if <span
class="math inline">\(S_{t}=s .\)</span> Like <span
class="math inline">\(p, \pi\)</span> is an ordinary function; the “|”
in the middle of <span class="math inline">\(\pi(a \mid s)\)</span>
merely reminds us that it defines a probability distribution over <span
class="math inline">\(a \in \mathcal{A}(s)\)</span> for each <span
class="math inline">\(s \in \mathcal{S}\)</span>. Reinforcement learning
methods specify how the agent’s policy is changed as a result of its
experience.</p>
<p>The <strong>value function</strong> of a state <span
class="math inline">\(s\)</span> under a <strong>policy <span
class="math inline">\(\pi\)</span></strong>, denoted <span
class="math inline">\(v_{\pi}(s)\)</span>, is the expected return when
starting in <span class="math inline">\(s\)</span> and following <span
class="math inline">\(\pi\)</span> thereafter. For MDPs, we can define
<span class="math inline">\(v_{\pi}\)</span> formally by</p>
<p><span class="math display">\[
v_{\pi}(s) \doteq \mathbb{E}_{\pi}\left[G_{t} \mid
S_{t}=s\right]=\mathbb{E}_{\pi}\left[\sum_{k=0}^{\infty} \gamma^{k}
R_{t+k+1} \mid S_{t}=s\right], \text { for all } s \in \mathcal{S}
\]</span></p>
<p>We call the <em>function <span class="math inline">\(v_{\pi}\)</span>
the state-value function for policy <span
class="math inline">\(\pi\)</span>.</em></p>
<p><strong>Q-function</strong></p>
<p>Similarly, we define the value of taking action <span
class="math inline">\(a\)</span> in state <span
class="math inline">\(s\)</span> under a policy <span
class="math inline">\(\pi\)</span>, denoted <span
class="math inline">\(q_{\pi}(s, a)\)</span>, as the expected return
starting from <span class="math inline">\(s\)</span>, taking the action
<span class="math inline">\(a\)</span>, and thereafter following policy
<span class="math inline">\(\pi\)</span> :</p>
<p><span class="math display">\[
q_{\pi}(s, a) \doteq \mathbb{E}_{\pi}\left[G_{t} \mid S_{t}=s,
A_{t}=a\right]=\mathbb{E}_{\pi}\left[\sum_{k=0}^{\infty} \gamma^{k}
R_{t+k+1} \mid S_{t}=s, A_{t}=a\right] .
\]</span></p>
<p>We call <span class="math inline">\(q_{\pi}\)</span> the action-value
function for policy <span class="math inline">\(\pi\)</span>.</p>

    </div>
    
</div>
</div>

                <div id="footer-wrapper">
                    <footer class="footer"><footer class="row pl-3 pr-3">
    <div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
        <div class="footer-left">
            <p class="mb-0"> © 2022 <a href="https://github.com/chen-gz">guangzong</a>. <span data-toggle="tooltip"
                    data-placement="top"
                    title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All
                    rights reserved.</span></p>
        </div>
        <div class="footer-right">
            <p class="mb-0"> Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">hugo</a>
                with <a href="https://github.com/chen-gz/hugo_zong" target="_blank" rel="noopener">zong</a>
                theme.</p>
        </div>
    </div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script> MathJax = {
            tex: {
                tags: 'ams',
            }
        };</script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</footer>
</footer>
                </div>
            </div>
            <div id="panel-wrapper" class="d-flex flex-column"><div id="toc-wrapper" class="mb-5 pl-2">
    <span>Contents</span>
    <nav id="toc" data-toggle="toc">
        
        
        
    </nav>
</div>

<div id="access-lastmod" class="pb-4 pl-2">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-3 pb-1 ml-1 mt-2">
          
        <li><a href="https://zongpitt.com/papa-rudin/ch-7/3-differentiable-transformations/">Differentiable Transformations</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-7/1-derivatives-of-measures/">Derivatives of Measures</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-7/2-the-fundamental-theorem-of-calculus/">The Fundamental Theorem of Calculus</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-6/1-total-variation/">Total Variation</a></li>
        
        <li><a href="https://zongpitt.com/papa-rudin/ch-6/3-consequences-of-the-radon-nikodym-theorem/">Consequences of the Radon-Nikodym Theorem</a></li>
        
    </ul>
</div>

<div id="access-tags" class="pl-2">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">
        
        <a class="post-tag" href="https://zongpitt.com/tags/algorithm/">Algorithm</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/android/">Android</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/c/">C</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/c-language/">c language</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/caddy/">Caddy</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/cadence/">Cadence</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/cdc/">CDC</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/classification/">classification</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/compress/">Compress</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/conf/">Conf</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/double-column/">Double Column</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/errno13/">Errno13</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/fish/">fish</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/gan/">GAN</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/git/">Git</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/gtk/">Gtk</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/html/">Html</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/i3/">I3</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/idea/">Idea</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/java/">Java</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/latex/">Latex</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/lda/">LDA</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/linear-programming/">Linear Programming</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/linux/">Linux</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/lr/">LR</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/math/">Math</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/mathematics/">Mathematics</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/matlab/">Matlab</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/matplot/">matplot</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/memory/">Memory</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/mermaid/">Mermaid</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/misc/">Misc</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/ml/">ML</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/mosfet/">Mosfet</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/network/">Network</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/nn/">NN</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/pandoc/">Pandoc</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/pca/">PCA</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/probability/">Probability</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/productive/">Productive</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/program/">Program</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/programming/">Programming</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/python/">Python</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/qt/">Qt</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/random-variable/">Random Variable</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/rcnn/">RCNN</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/rust/">Rust</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/security/">Security</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/software/">Software</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/std/">Std</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/svd/">Svd</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/tool/">Tool</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/usb/">USB</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/vim/">Vim</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/vpn/">Vpn</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/vpnc/">Vpnc</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/xterm/">xterm</a>
        
        <a class="post-tag" href="https://zongpitt.com/tags/zsh/">Zsh</a>
        
    </div>
</div>
</div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
    <div class="col-12 col-sm-11 post-content">
        <div id="search-hints"></div>
        <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3 col-12"></div>
    </div>
</div>

<script src="/js/fuse.min.js"></script>
<script src="/js/fastsearch.js"></script>


</div>
        <div id="mask"></div>
        <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"
            style="display: none">
            <i class="fas fa-angle-up"></i>
        </a>
    </div>
    
</body>

</html>
